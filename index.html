<!DOCTYPE html>
<html>
	<head>
		<meta charset='utf-8'>
		<meta http-equiv='X-UA-Compatible' content='IE=edge'>
		<title>Protein-Go demo</title>
		<script src='https://aframe.io/releases/0.9.2/aframe.min.js'></script>
		<script src="https://cdn.rawgit.com/jeromeetienne/AR.js/master/aframe/build/aframe-ar.js"></script>
	   	<script src="https://google-ar.github.io/three.ar.js/dist/three.ar.js"></script>
		<script src="https://rawgit.com/chenzlabs/aframe-ar/827e9db/dist/aframe-ar.min.js"></script>
		<script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/cfe5f316/dist/aframe-extras.js"></script>
	</head>
	<body style='margin: 0; overflow: hidden;'>
		<a-scene ar vr-mode-ui="enabled: false"
				embedded  
			 webxr="requiredFeatures: hit-test,local-floor;
				optionalFeatures: dom-overlay,unbounded;
				overlayElement: #overlay;">
			<a-camera ar-raycaster raycaster cursor="fuse:false"></a-camera>
			<a-gltf-model id=#capsid src="separated_colored.glb" scale="0.1 0.1 0.1" position="0 0 -40" rotation="0 -90 0" animation-mixer shadow="cast: true"></a-gltf-model>
			<a-ring id="cursor" color="teal" radius-inner="0.02" radius-outer="0.03" position="0 -3 -3" rotation="-90 0 0"></a-ring>
		</a-scene>
		<script type="text/javascript">
				const walker = document.querySelector('#capsid');
				const { stringify } = AFRAME.utils.coordinates;

				let firstTime = true;
				raycaster.addEventListener('click', () => {
					const target = raycaster.components.cursor.intersection.point;

					if (firstTime) {
					walker.setAttribute('position', target);
					firstTime = false;
					} else {
					const currentPosition = walker.object3D.position;
					const distance = currentPosition.distanceTo(target);

					walker.object3D.lookAt(target);

					const animation = document.createElement('a-animation');
					animation.setAttribute('attribute', 'position');
					animation.setAttribute('to', stringify(target));
					animation.setAttribute('dur', distance * 70);
					animation.setAttribute('easing', 'linear');
					walker.appendChild(animation);
					}
					});
			      }

		      const scene = document.querySelector('a-scene');
		      scene.addEventListener('loaded', onSceneLoaded);
		</script>
	</body>
</html>
